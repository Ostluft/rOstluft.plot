<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Summarise z values over binned wind data. — geom_bar_wind • rOstluft.plot</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Summarise z values over binned wind data. — geom_bar_wind"><meta property="og:description" content="All calculation are done by summary_wind(), see the documentation for the details.
stat_summary_wind() uses the aesthetics ws, wd and z to map the correspondent arguments
for summary_wind(). The computed variables are named ws, wd and z. geom_bar_wind()
is an extension to ggplot2::geom_bar() with stat_summary_wind() as default stat and correct
handling of the factorized x aesthetic. To map the computed Variables use ggplot2::stat()."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rOstluft.plot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/articles/Kalender_Linie.html">Linien Kalender</a>
    </li>
    <li>
      <a href="../articles/articles/Wind_Density.html">Diurnal Wind als Density und Boxplot</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Ostluft/rOstluft.plot" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Summarise z values over binned wind data.</h1>
    <small class="dont-index">Source: <a href="https://github.com/Ostluft/rOstluft.plot/blob/HEAD/R/geom_bar_wind.R" class="external-link"><code>R/geom_bar_wind.R</code></a>, <a href="https://github.com/Ostluft/rOstluft.plot/blob/HEAD/R/stat_summary_wind.R" class="external-link"><code>R/stat_summary_wind.R</code></a></small>
    <div class="hidden name"><code>geom_bar_wind.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>All calculation are done by <code><a href="summary_wind.html">summary_wind()</a></code>, see the documentation for the details.
<code>stat_summary_wind()</code> uses the aesthetics <code>ws</code>, <code>wd</code> and <code>z</code> to map the correspondent arguments
for <code><a href="summary_wind.html">summary_wind()</a></code>. The computed variables are named <code>ws</code>, <code>wd</code> and <code>z</code>. <code>geom_bar_wind()</code>
is an extension to <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar()</a></code> with <code>stat_summary_wind()</code> as default stat and correct
handling of the factorized <code>x</code> aesthetic. To map the computed Variables use <code><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">ggplot2::stat()</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">geom_bar_wind</span><span class="op">(</span>
  mapping <span class="op">=</span> <span class="cn">NULL</span>,
  data <span class="op">=</span> <span class="cn">NULL</span>,
  stat <span class="op">=</span> <span class="st">"summary_wind"</span>,
  position <span class="op">=</span> <span class="st">"stack"</span>,
  <span class="va">...</span>,
  fun <span class="op">=</span> <span class="st">"mean"</span>,
  fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  nmin <span class="op">=</span> <span class="fl">3</span>,
  wd_cutfun <span class="op">=</span> <span class="fu"><a href="cut_wd.fun.html">cut_wd.fun</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">45</span><span class="op">)</span>,
  ws_cutfun <span class="op">=</span> <span class="fu"><a href="cut_ws.fun.html">cut_ws.fun</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,
  show.legend <span class="op">=</span> <span class="cn">NA</span>,
  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu">stat_summary_wind</span><span class="op">(</span>
  data <span class="op">=</span> <span class="cn">NULL</span>,
  mapping <span class="op">=</span> <span class="cn">NULL</span>,
  geom <span class="op">=</span> <span class="st">"bar_wind"</span>,
  position <span class="op">=</span> <span class="st">"stack"</span>,
  <span class="va">...</span>,
  groupings <span class="op">=</span> <span class="fu"><a href="grp.html">grp</a></span><span class="op">(</span><span class="op">)</span>,
  fun <span class="op">=</span> <span class="st">"mean"</span>,
  fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  nmin <span class="op">=</span> <span class="fl">3</span>,
  wd_cutfun <span class="op">=</span> <span class="fu"><a href="cut_wd.fun.html">cut_wd.fun</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">45</span><span class="op">)</span>,
  ws_cutfun <span class="op">=</span> <span class="fu"><a href="cut_ws.fun.html">cut_ws.fun</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,
  show.legend <span class="op">=</span> <span class="cn">NA</span>,
  inherit.aes <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mapping</dt>
<dd><p>Set of aesthetic mappings created by <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> or
<code><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_()</a></code>. If specified and <code>inherit.aes = TRUE</code> (the
default), it is combined with the default mapping at the top level of the
plot. You must supply <code>mapping</code> if there is no plot mapping.</p></dd>
<dt>data</dt>
<dd><p>a data.frame or tibble containing the data (wide format)</p></dd>
<dt>stat</dt>
<dd><p>The statistical transformation to use on the data for this
layer, as a string.</p></dd>
<dt>position</dt>
<dd><p>Position adjustment, either as a string, or the result of
a call to a position adjustment function.</p></dd>
<dt>...</dt>
<dd><p>Other arguments passed on to <code><a href="https://ggplot2.tidyverse.org/reference/layer.html" class="external-link">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p></dd>
<dt>fun</dt>
<dd><p>function or list of functions for summary.</p></dd>
<dt>fun.args</dt>
<dd><p>a list of extra arguments passed on to fun.</p></dd>
<dt>nmin</dt>
<dd><p>numeric, minimum number of values for fun, if n &lt; nmin: NA is returned</p></dd>
<dt>wd_cutfun</dt>
<dd><p>function, cut function for wind direction (to create bins). See <code><a href="cut_wd.fun.html">cut_wd.fun()</a></code> for options.</p></dd>
<dt>ws_cutfun</dt>
<dd><p>function, cut function for wind speed. See <code><a href="cut_ws.fun.html">cut_ws.fun()</a></code> for examples</p></dd>
<dt>na.rm</dt>
<dd><p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p></dd>
<dt>show.legend</dt>
<dd><p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p></dd>
<dt>inherit.aes</dt>
<dd><p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="https://ggplot2.tidyverse.org/reference/borders.html" class="external-link">borders()</a></code>.</p></dd>
<dt>geom</dt>
<dd><p>The geometric object to use display the data</p></dd>
<dt>groupings</dt>
<dd><p>additional groupings. Use helper <code><a href="grp.html">grp()</a></code> to create</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code><a href="https://ggplot2.tidyverse.org/reference/layer.html" class="external-link">ggplot2::layer()</a></code></p>
    </div>
    <div id="recommendation">
    <h2>Recommendation</h2>
    


<p>The facetting functions takes the inputs and evaluate them in the context of the dataset.
This means it is impossible to use a computed variable from a stat or from an asthetic.
This limitation means <code><a href="summary_wind.html">summary_wind()</a></code> isn't a good fit with ggplot as a stat.</p>
<p>In most cases it is simpler to summarize the data beforehand and then create a plot
from the summarized data.</p>
<p><code><a href="ggwindrose.html">ggwindrose()</a></code> and <code><a href="ggradar.html">ggradar()</a></code> can be used to create some standardized plots.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu">rOstluft.data</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rOstluft.data/man/f.html" class="external-link">f</a></span><span class="op">(</span><span class="st">"Zch_Stampfenbachstrasse_2010-2014.csv"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">rOstluft</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rOstluft/man/read_airmo_csv.html" class="external-link">read_airmo_csv</a></span><span class="op">(</span><span class="va">fn</span><span class="op">)</span></span>
<span class="r-in"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">rOstluft</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rOstluft/man/rolf_to_openair.html" class="external-link">rolf_to_openair</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># a simple wind rose</span></span>
<span class="r-in"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">wd</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">freq</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">ws</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu">geom_bar_wind</span><span class="op">(</span></span>
<span class="r-in">    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>wd <span class="op">=</span> <span class="va">wd</span>, ws <span class="op">=</span> <span class="va">ws</span>, z <span class="op">=</span> <span class="va">ws</span><span class="op">)</span>,</span>
<span class="r-in">    ws_cutfun <span class="op">=</span> <span class="fu"><a href="cut_ws.fun.html">cut_ws.fun</a></span><span class="op">(</span>ws_max <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span class="r-in">    width <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">    color <span class="op">=</span> <span class="st">"white"</span></span>
<span class="r-in">  <span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="coord_polar2.html">coord_polar2</a></span><span class="op">(</span>start <span class="op">=</span> <span class="op">-</span> <span class="fl">22.5</span> <span class="op">/</span> <span class="fl">180</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 27 rows containing non-finite values (stat_summary_wind).</span>
<span class="r-plt img"><img src="geom_bar_wind-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">#</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># use stat_summary_wind to generate a radar plot using</span></span>
<span class="r-in"><span class="co"># the polygon geom, position "identity" and coord_radar()</span></span>
<span class="r-in"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">  <span class="st">"median"</span>,</span>
<span class="r-in">  <span class="st">"mean"</span>,</span>
<span class="r-in">  <span class="st">"perc95"</span> <span class="op">=</span> <span class="op">~</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">.</span>, probs <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">wd</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">stat</span><span class="op">)</span>, group <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">stat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu">stat_summary_wind</span><span class="op">(</span></span>
<span class="r-in">    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>wd <span class="op">=</span> <span class="va">wd</span>, ws <span class="op">=</span> <span class="va">ws</span>, z <span class="op">=</span> <span class="va">NOx</span><span class="op">)</span>,</span>
<span class="r-in">    geom <span class="op">=</span> <span class="st">"polygon"</span>, position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span class="r-in">    fun <span class="op">=</span> <span class="va">f</span>,</span>
<span class="r-in">    ws_cutfun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"ws"</span><span class="op">)</span>,</span>
<span class="r-in">    fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span class="r-in">    size <span class="op">=</span> <span class="fl">1</span></span>
<span class="r-in">  <span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="coord_radar.html">coord_radar</a></span><span class="op">(</span>start <span class="op">=</span> <span class="op">-</span> <span class="fl">22.5</span> <span class="op">/</span> <span class="fl">180</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 767 rows containing non-finite values (stat_summary_wind).</span>
<span class="r-plt img"><img src="geom_bar_wind-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># ggplot2 doesn't support faceting over a Variable computed in a stat.</span></span>
<span class="r-in"><span class="co"># But we can summarise the data first and then create the plot.</span></span>
<span class="r-in"><span class="co"># Less ggplot2 magic, but more transparent for the user</span></span>
<span class="r-in"><span class="va">data_summarized</span> <span class="op">&lt;-</span> <span class="fu"><a href="summary_wind.html">summary_wind</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">ws</span>, <span class="va">wd</span>, <span class="va">NOx</span>, fun <span class="op">=</span> <span class="va">f</span>,</span>
<span class="r-in">  ws_cutfun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"ws"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_summarized</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wd</span>, y <span class="op">=</span> <span class="va">NOx</span>, color <span class="op">=</span> <span class="va">stat</span>, group <span class="op">=</span> <span class="va">stat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="coord_radar.html">coord_radar</a></span><span class="op">(</span>start <span class="op">=</span> <span class="op">-</span> <span class="fl">22.5</span> <span class="op">/</span> <span class="fl">180</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">stat</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="geom_bar_wind-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># like faceting the mapping mechanism makes it hard to impossible</span></span>
<span class="r-in"><span class="co"># to use the grouping argument of summary wind. Do the summarise</span></span>
<span class="r-in"><span class="co"># external.</span></span>
<span class="r-in"><span class="co"># For example: how often comes which concentration from a sector</span></span>
<span class="r-in"><span class="va">data_summarized</span> <span class="op">&lt;-</span> <span class="fu"><a href="summary_wind.html">summary_wind</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">ws</span>, <span class="va">wd</span>, <span class="va">NOx</span>,</span>
<span class="r-in">  groupings <span class="op">=</span> <span class="fu"><a href="grp.html">grp</a></span><span class="op">(</span></span>
<span class="r-in">    fNOx <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/cut_interval.html" class="external-link">cut_number</a></span><span class="op">(</span><span class="va">NO2</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span class="r-in">    year <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  ws_cutfun <span class="op">=</span> <span class="fu"><a href="cut_interval.fun.html">cut_number.fun</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_summarized</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wd</span>, y <span class="op">=</span> <span class="va">freq</span>, fill <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="va">fNOx</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="coord_polar2.html">coord_polar2</a></span><span class="op">(</span>start <span class="op">=</span> <span class="op">-</span> <span class="fl">22.5</span> <span class="op">/</span> <span class="fl">180</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, name <span class="op">=</span> <span class="st">"NOx"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="geom_bar_wind-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thomas von Allmen, Jörg Sintermann.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

